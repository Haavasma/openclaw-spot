services:
  openclaw:
    image: coollabsio/openclaw:latest
    restart: unless-stopped
    ports:
      - "${PORT:-8080}:${PORT:-8080}"
      - "18789:18789"
    environment:
      - OPENCLAW_GATEWAY_TOKEN=${OPENCLAW_GATEWAY_TOKEN}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
      - BROWSER_CDP_URL=http://browser:9223
      - BROWSER_DEFAULT_PROFILE=openclaw
      - BROWSER_EVALUATE_ENABLED=true
    volumes:
      - /mnt/openclaw-data:/data
    depends_on:
      - browser
    mem_limit: "3g"
    pids_limit: 256
    security_opt:
      - no-new-privileges:true

  browser:
    image: coollabsio/openclaw-browser:latest
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Etc/UTC
      - CHROME_CLI=--remote-debugging-port=9222
    volumes:
      - browser-data:/config
    shm_size: 2g

volumes:
  browser-data:
